{% extends "base.html.twig" %}

{% block title %}Catégorie {{ category.Name }} - Phase {{ phase }} - {% endblock %}


{% block body %}

    <div class="row mb-4">
        {% for phase in category.phases %}
            <div class="col-4"><a class="btn btn-primary w-100 text-center" href="{{ path("category_display_phase",{id:category.id,phase:phase.id}) }}">{{ phase.Name }}</a></div>
        {% endfor %}


    </div>

    <h1>Catégorie {{ category.Name }} - Phase {{ phase }}</h1>


    <div id="data">

    </div>


{% endblock %}

{% block javascript %}
fetch("//localhost:8000/api/data/phase?phase={{ phase }}&category={{ category.id }}").then((data)=>{
    //console.log(data);
    data.json().then((jsonData)=>{
        //console.log(jsonData);
        let equipe = jsonData.data;
        console.log(equipe);
        for(const namePoule in equipe){
            //console.log(namePoule);
            let poule = equipe[namePoule];
            //console.log(poule);
                    let div = document.createElement("div");
                    div.classList.add("mb-5");

                    let btn = document.createElement("a");
                    div.append(btn);
                    btn.innerText = "voir tous les matchs";
                    btn.setAttribute("href","//localhost:8000/matchs/1/phase/{{ phase }}/groupe/"+namePoule);
                    btn.classList.add("btn","btn-secondary","float-end","btn-sm");

                    let h3 = document.createElement("h3");
                    h3.innerHTML = "Poule " + namePoule;
                    document.getElementById('data').appendChild(div);
                    div.appendChild(h3);



                    table = document.createElement("table");
                    table.classList.add( "table","table-bordered","table-responsive", "table-striped" )
                    div.appendChild(table);

                    let thead = document.createElement("thead");
                    thead.classList.add("thead-dark")
                    table.appendChild(thead);

                    let tbody = document.createElement("tbody");
                    table.appendChild(tbody);

                    let th = document.createElement("td");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "Equipe";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "Points";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "But Pour";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "But Contre";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "V";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "N";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                    th = document.createElement("th");
                    th.innerText = "D";
                    th.setAttribute("scope", "col");
                    thead.appendChild(th);

                equipe[namePoule].forEach((team)=>{
                    //console.log(team);
                    tr = document.createElement("tr");
                    tbody.appendChild(tr);

                    td = document.createElement("td");
                    tr.appendChild(td);
                    
                    td = document.createElement("td");
                    td.innerHTML = team.Name;
                    tr.appendChild(td);

                    td = document.createElement("td");
                    td.innerHTML = team.pts;
                    tr.appendChild(td);

                    td = document.createElement("td");
                    td.innerHTML= team.but_contre;
                    tr.appendChild(td);


                    td = document.createElement("td");
                    td.innerHTML= team.but_pour;
                    tr.appendChild(td);

                    

                    td = document.createElement("td");
                    td.innerHTML = team.victoire;
                    tr.appendChild(td);

                    td = document.createElement("td");
                    td.innerHTML = team.nul;
                    tr.appendChild(td);

                    td = document.createElement("td");
                    td.innerHTML = team.defaite;
                    tr.appendChild(td);

                });
        };
    });
});


var urlposition = "http://localhost:8000/api/poule/5486/positions";

fetch(urlposition).then(function(resultas){
    //console.log(resultas);
    resultas.json().then(function(data){
        //console.log(data);
    })
});

//setInterval(function(){
//    location.reload();
//}30000)
{% endblock %}